package GetVersion;
import java.util.ArrayList;

import org.apache.poi.ss.usermodel.Row;

public class VulnerabilityInfo {

    ExcelUtil excelUtil = new ExcelUtil();

    public class VulnerInfo {
        public String cve = ""; // cve号
        public String softwareVersion = ""; // 含漏洞软件版本
        public String fileName = ""; // 漏洞文件名
        public String functionName = ""; // 漏洞函数名
        public ArrayList<String> containVersions = new ArrayList<String>(); // 检查后包含漏洞的版本
    }

    /**
     * 从excel中读取
     * 
     * @param filePath
     *            excel路径
     * @return 预置数据信息数组，不正确时返回{@code null}
     */
    ArrayList<VulnerInfo> readInfoFromExcel(String filePath) {
        ArrayList<VulnerInfo> vulnerInfos = new ArrayList<VulnerInfo>();
        if (filePath == null) {
            return vulnerInfos;
        }
        ArrayList<Row> rows = excelUtil.readExcelHssfRows(filePath, 0);
        if (rows.size() == 0) {
            return vulnerInfos;
        }
        rows.remove(0);
        for (Row row : rows) {
            VulnerInfo vulnerInfo = new VulnerInfo();
            vulnerInfo.cve = excelUtil.getCellStringValue(row, 0);
            vulnerInfo.softwareVersion = excelUtil.getCellStringValue(row, 3);
            // 多文件处理
            vulnerInfo.fileName = excelUtil.getCellStringValue(row, 4);
            // 多函数处理
            vulnerInfo.functionName = excelUtil.getCellStringValue(row, 5);
            vulnerInfos.add(vulnerInfo);
        }
        return vulnerInfos;
    }

    public static void main(String[] args) {
        // TODO Auto-generated method stub
        String excelPath = "C:\\Users\\yytang\\Desktop\\all\\all\\test.xlsx";
        VulnerabilityInfo vulnerabilityInfo = new VulnerabilityInfo();
        ArrayList<VulnerInfo> vulnerInfos = vulnerabilityInfo.readInfoFromExcel(excelPath);

        for (VulnerInfo vulnerInfo : vulnerInfos) {
            System.out.println(vulnerInfo.cve + "\t" + vulnerInfo.softwareVersion + "\t"
                    + vulnerInfo.fileName + "\t" + vulnerInfo.functionName);
        }
        System.out.println("总数：" + vulnerInfos.size());
    }
}
